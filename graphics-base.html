<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Graphics in base R | Introduction to R</title>
  <meta name="description" content="This is the material for the course Introduction to R, given at Karolinska Institutet, Stockholm, Sweden, as part of the doctoral program in epidemiology." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Graphics in base R | Introduction to R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the material for the course Introduction to R, given at Karolinska Institutet, Stockholm, Sweden, as part of the doctoral program in epidemiology." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Graphics in base R | Introduction to R" />
  
  <meta name="twitter:description" content="This is the material for the course Introduction to R, given at Karolinska Institutet, Stockholm, Sweden, as part of the doctoral program in epidemiology." />
  



<meta name="date" content="2024-03-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression-other.html"/>
<link rel="next" href="graphics-ggplot2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this document</a></li>
<li class="part"><span><b>I Getting started</b></span></li>
<li class="chapter" data-level="1" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>1</b> Background</a>
<ul>
<li class="chapter" data-level="1.1" data-path="background.html"><a href="background.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="background.html"><a href="background.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.2</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.3" data-path="background.html"><a href="background.html#software-installation"><i class="fa fa-check"></i><b>1.3</b> Software installation</a></li>
<li class="chapter" data-level="1.4" data-path="background.html"><a href="background.html#references"><i class="fa fa-check"></i><b>1.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Working with R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#starting-r"><i class="fa fa-check"></i><b>2.1</b> Starting R</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#storing-data-as-objects"><i class="fa fa-check"></i><b>2.2</b> Storing data as objects</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#about-variable-names"><i class="fa fa-check"></i><b>2.2.1</b> About variable names</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#data-structure-i-the-vector"><i class="fa fa-check"></i><b>2.3</b> Data structure I: The vector</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction.html"><a href="introduction.html#ex-simple-desc"><i class="fa fa-check"></i><b>2.3.1</b> Example: simple descriptives</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction.html"><a href="introduction.html#ex-simple-plots"><i class="fa fa-check"></i><b>2.3.2</b> Example: simple plots</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#non-numeric-data"><i class="fa fa-check"></i><b>2.4</b> Non-numeric data</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction.html"><a href="introduction.html#descriptives-for-grouping-data"><i class="fa fa-check"></i><b>2.4.1</b> Descriptives for grouping data</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction.html"><a href="introduction.html#character-vector-vs-factor"><i class="fa fa-check"></i><b>2.4.2</b> Character vector vs factor</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#general-data-in-r"><i class="fa fa-check"></i><b>2.5</b> General data in R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction.html"><a href="introduction.html#extracting-parts-of-a-data-frame"><i class="fa fa-check"></i><b>2.5.1</b> Extracting parts of a data frame</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction.html"><a href="introduction.html#ex_desc_stats"><i class="fa fa-check"></i><b>2.5.2</b> Example: descriptive statistics</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction.html"><a href="introduction.html#meta-activity"><i class="fa fa-check"></i><b>2.6</b> Meta-activity</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction.html"><a href="introduction.html#getting-help"><i class="fa fa-check"></i><b>2.6.1</b> Getting help</a></li>
<li class="chapter" data-level="2.6.2" data-path="introduction.html"><a href="introduction.html#keeping-track-of-objects"><i class="fa fa-check"></i><b>2.6.2</b> Keeping track of objects</a></li>
<li class="chapter" data-level="2.6.3" data-path="introduction.html"><a href="introduction.html#finding-files"><i class="fa fa-check"></i><b>2.6.3</b> Finding files</a></li>
<li class="chapter" data-level="2.6.4" data-path="introduction.html"><a href="introduction.html#quitting-r"><i class="fa fa-check"></i><b>2.6.4</b> Quitting R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intro_rstudio.html"><a href="intro_rstudio.html"><i class="fa fa-check"></i><b>3</b> Working in RStudio</a>
<ul>
<li class="chapter" data-level="3.1" data-path="intro_rstudio.html"><a href="intro_rstudio.html#getting-started"><i class="fa fa-check"></i><b>3.1</b> Getting started</a></li>
<li class="chapter" data-level="3.2" data-path="intro_rstudio.html"><a href="intro_rstudio.html#a-quick-tour-of-the-gui"><i class="fa fa-check"></i><b>3.2</b> A quick tour of the GUI</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="intro_rstudio.html"><a href="intro_rstudio.html#console-and-friends"><i class="fa fa-check"></i><b>3.2.1</b> Console and friends</a></li>
<li class="chapter" data-level="3.2.2" data-path="intro_rstudio.html"><a href="intro_rstudio.html#rstudio-console-specials"><i class="fa fa-check"></i><b>3.2.2</b> RStudio Console specials</a></li>
<li class="chapter" data-level="3.2.3" data-path="intro_rstudio.html"><a href="intro_rstudio.html#navigating-the-pane-layout"><i class="fa fa-check"></i><b>3.2.3</b> Navigating the pane layout</a></li>
<li class="chapter" data-level="3.2.4" data-path="intro_rstudio.html"><a href="intro_rstudio.html#the-default-upper-pane"><i class="fa fa-check"></i><b>3.2.4</b> The default upper pane</a></li>
<li class="chapter" data-level="3.2.5" data-path="intro_rstudio.html"><a href="intro_rstudio.html#def-lower-pane"><i class="fa fa-check"></i><b>3.2.5</b> The default lower pane</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="intro_rstudio.html"><a href="intro_rstudio.html#source-pane-scripting"><i class="fa fa-check"></i><b>3.3</b> Source pane &amp; scripting</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="intro_rstudio.html"><a href="intro_rstudio.html#console2source"><i class="fa fa-check"></i><b>3.3.1</b> From console to source</a></li>
<li class="chapter" data-level="3.3.2" data-path="intro_rstudio.html"><a href="intro_rstudio.html#the-source-pane-file-editor"><i class="fa fa-check"></i><b>3.3.2</b> The Source pane file editor</a></li>
<li class="chapter" data-level="3.3.3" data-path="intro_rstudio.html"><a href="intro_rstudio.html#displays"><i class="fa fa-check"></i><b>3.3.3</b> Displays</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="intro-example.html"><a href="intro-example.html"><i class="fa fa-check"></i><b>4</b> A simple example</a>
<ul>
<li class="chapter" data-level="4.1" data-path="intro-example.html"><a href="intro-example.html#intro-ex-import"><i class="fa fa-check"></i><b>4.1</b> Data import</a></li>
<li class="chapter" data-level="4.2" data-path="intro-example.html"><a href="intro-example.html#analysis"><i class="fa fa-check"></i><b>4.2</b> Analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="intro-example.html"><a href="intro-example.html#desc-ex"><i class="fa fa-check"></i><b>4.2.1</b> Descriptives</a></li>
<li class="chapter" data-level="4.2.2" data-path="intro-example.html"><a href="intro-example.html#blood-pressure-by-salt-intake"><i class="fa fa-check"></i><b>4.2.2</b> Blood pressure by salt intake</a></li>
<li class="chapter" data-level="4.2.3" data-path="intro-example.html"><a href="intro-example.html#salt-intake-by-sex"><i class="fa fa-check"></i><b>4.2.3</b> Salt intake by sex</a></li>
<li class="chapter" data-level="4.2.4" data-path="intro-example.html"><a href="intro-example.html#save-results"><i class="fa fa-check"></i><b>4.2.4</b> Save results</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="intro-example.html"><a href="intro-example.html#turning-into-script"><i class="fa fa-check"></i><b>4.3</b> Turning it into a script</a></li>
<li class="chapter" data-level="4.4" data-path="intro-example.html"><a href="intro-example.html#exp-res"><i class="fa fa-check"></i><b>4.4</b> Exporting results</a></li>
</ul></li>
<li class="part"><span><b>II Working with data</b></span></li>
<li class="chapter" data-level="5" data-path="data-types-struct.html"><a href="data-types-struct.html"><i class="fa fa-check"></i><b>5</b> Data types and structures</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-types-struct.html"><a href="data-types-struct.html#overview"><i class="fa fa-check"></i><b>5.1</b> Overview</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-types-struct.html"><a href="data-types-struct.html#data-examples"><i class="fa fa-check"></i><b>5.1.1</b> Data examples</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-types-struct.html"><a href="data-types-struct.html#background-1"><i class="fa fa-check"></i><b>5.2</b> Background</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-types-struct.html"><a href="data-types-struct.html#recap"><i class="fa fa-check"></i><b>5.2.1</b> Recap</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-types-struct.html"><a href="data-types-struct.html#motivation"><i class="fa fa-check"></i><b>5.2.2</b> Motivation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-types-struct.html"><a href="data-types-struct.html#more-about-vectors"><i class="fa fa-check"></i><b>5.3</b> More about vectors</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-types-struct.html"><a href="data-types-struct.html#vector-calculations"><i class="fa fa-check"></i><b>5.3.1</b> Vector calculations</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-types-struct.html"><a href="data-types-struct.html#indexing-vectors-by-position"><i class="fa fa-check"></i><b>5.3.2</b> Indexing vectors by position</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-types-struct.html"><a href="data-types-struct.html#logical-data"><i class="fa fa-check"></i><b>5.4</b> Logical data</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-types-struct.html"><a href="data-types-struct.html#definition"><i class="fa fa-check"></i><b>5.4.1</b> Definition</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-types-struct.html"><a href="data-types-struct.html#logical-expressions"><i class="fa fa-check"></i><b>5.4.2</b> Logical expressions</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-types-struct.html"><a href="data-types-struct.html#logical-vectors"><i class="fa fa-check"></i><b>5.4.3</b> Logical vectors</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-types-struct.html"><a href="data-types-struct.html#logical-vectors-for-indexing"><i class="fa fa-check"></i><b>5.4.4</b> Logical vectors for indexing</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-types-struct.html"><a href="data-types-struct.html#more-on-rectangular-data"><i class="fa fa-check"></i><b>5.5</b> More on rectangular data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-types-struct.html"><a href="data-types-struct.html#data-frame"><i class="fa fa-check"></i><b>5.5.1</b> Data frame</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-types-struct.html"><a href="data-types-struct.html#matrix"><i class="fa fa-check"></i><b>5.5.2</b> Matrix</a></li>
<li class="chapter" data-level="5.5.3" data-path="data-types-struct.html"><a href="data-types-struct.html#extensions-alternatives"><i class="fa fa-check"></i><b>5.5.3</b> Extensions &amp; alternatives</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-types-struct.html"><a href="data-types-struct.html#helpers-subset-and-transform"><i class="fa fa-check"></i><b>5.6</b> Helpers: <code>subset</code> and <code>transform</code></a></li>
<li class="chapter" data-level="5.7" data-path="data-types-struct.html"><a href="data-types-struct.html#list-struct"><i class="fa fa-check"></i><b>5.7</b> Free-style data: lists</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-types-struct.html"><a href="data-types-struct.html#background-2"><i class="fa fa-check"></i><b>5.7.1</b> Background</a></li>
<li class="chapter" data-level="5.7.2" data-path="data-types-struct.html"><a href="data-types-struct.html#basic_lists"><i class="fa fa-check"></i><b>5.7.2</b> Basic list</a></li>
<li class="chapter" data-level="5.7.3" data-path="data-types-struct.html"><a href="data-types-struct.html#named_lists"><i class="fa fa-check"></i><b>5.7.3</b> Named lists</a></li>
<li class="chapter" data-level="5.7.4" data-path="data-types-struct.html"><a href="data-types-struct.html#example-data-frames"><i class="fa fa-check"></i><b>5.7.4</b> Example: data frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-processing.html"><a href="data-processing.html"><i class="fa fa-check"></i><b>6</b> Processing data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-processing.html"><a href="data-processing.html#overview-1"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="data-processing.html"><a href="data-processing.html#group-stats"><i class="fa fa-check"></i><b>6.2</b> Groupwise statistics</a></li>
<li class="chapter" data-level="6.3" data-path="data-processing.html"><a href="data-processing.html#own-functions"><i class="fa fa-check"></i><b>6.3</b> Using your own functions</a></li>
<li class="chapter" data-level="6.4" data-path="data-processing.html"><a href="data-processing.html#split-apply-combine"><i class="fa fa-check"></i><b>6.4</b> Split - Apply - Combine</a></li>
<li class="chapter" data-level="6.5" data-path="data-processing.html"><a href="data-processing.html#merge-data-base"><i class="fa fa-check"></i><b>6.5</b> Merging data sets</a></li>
<li class="chapter" data-level="6.6" data-path="data-processing.html"><a href="data-processing.html#general-pipeline"><i class="fa fa-check"></i><b>6.6</b> Using pipelines</a></li>
<li class="chapter" data-level="6.7" data-path="data-processing.html"><a href="data-processing.html#next-steps"><i class="fa fa-check"></i><b>6.7</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-tidyverse.html"><a href="data-tidyverse.html"><i class="fa fa-check"></i><b>7</b> The <code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-tidyverse.html"><a href="data-tidyverse.html#overview-2"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="data-tidyverse.html"><a href="data-tidyverse.html#example-using-dplyr-for-data-processing"><i class="fa fa-check"></i><b>7.2</b> Example: Using <code>dplyr</code> for data processing</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="data-tidyverse.html"><a href="data-tidyverse.html#overview-3"><i class="fa fa-check"></i><b>7.2.1</b> Overview</a></li>
<li class="chapter" data-level="7.2.2" data-path="data-tidyverse.html"><a href="data-tidyverse.html#basic-data-operations"><i class="fa fa-check"></i><b>7.2.2</b> Basic data operations</a></li>
<li class="chapter" data-level="7.2.3" data-path="data-tidyverse.html"><a href="data-tidyverse.html#groupwise-data-operations"><i class="fa fa-check"></i><b>7.2.3</b> Groupwise data operations</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="data-tidyverse.html"><a href="data-tidyverse.html#tidyverse-vs-base-r"><i class="fa fa-check"></i><b>7.3</b> <code>tidyverse</code> vs base R?</a></li>
</ul></li>
<li class="part"><span><b>III Estimation, inference, modelling</b></span></li>
<li class="chapter" data-level="8" data-path="basic-stats-epi.html"><a href="basic-stats-epi.html"><i class="fa fa-check"></i><b>8</b> Basic Statistics &amp; Epidemiology</a>
<ul>
<li class="chapter" data-level="8.1" data-path="basic-stats-epi.html"><a href="basic-stats-epi.html#descriptives"><i class="fa fa-check"></i><b>8.1</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="basic-stats-epi.html"><a href="basic-stats-epi.html#base-desc"><i class="fa fa-check"></i><b>8.1.1</b> In base R</a></li>
<li class="chapter" data-level="8.1.2" data-path="basic-stats-epi.html"><a href="basic-stats-epi.html#using-package-summarytools"><i class="fa fa-check"></i><b>8.1.2</b> Using package <code>summarytools</code></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="basic-stats-epi.html"><a href="basic-stats-epi.html#confidence-intervals"><i class="fa fa-check"></i><b>8.2</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.3" data-path="basic-stats-epi.html"><a href="basic-stats-epi.html#statistical-tests"><i class="fa fa-check"></i><b>8.3</b> Statistical tests</a></li>
<li class="chapter" data-level="8.4" data-path="basic-stats-epi.html"><a href="basic-stats-epi.html#epidemiological-risk-measures"><i class="fa fa-check"></i><b>8.4</b> Epidemiological risk measures</a></li>
<li class="chapter" data-level="8.5" data-path="basic-stats-epi.html"><a href="basic-stats-epi.html#pander-intro"><i class="fa fa-check"></i><b>8.5</b> Improved display of descriptives</a></li>
<li class="chapter" data-level="8.6" data-path="basic-stats-epi.html"><a href="basic-stats-epi.html#next-steps-1"><i class="fa fa-check"></i><b>8.6</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression-linear.html"><a href="regression-linear.html"><i class="fa fa-check"></i><b>9</b> Linear regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regression-linear.html"><a href="regression-linear.html#overview-4"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="regression-linear.html"><a href="regression-linear.html#background-3"><i class="fa fa-check"></i><b>9.2</b> Background</a></li>
<li class="chapter" data-level="9.3" data-path="regression-linear.html"><a href="regression-linear.html#simple-linear-regression"><i class="fa fa-check"></i><b>9.3</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="regression-linear.html"><a href="regression-linear.html#scatter-loess"><i class="fa fa-check"></i><b>9.3.1</b> Looking at the data</a></li>
<li class="chapter" data-level="9.3.2" data-path="regression-linear.html"><a href="regression-linear.html#fitting-a-linear-regression-model"><i class="fa fa-check"></i><b>9.3.2</b> Fitting a linear regression model</a></li>
<li class="chapter" data-level="9.3.3" data-path="regression-linear.html"><a href="regression-linear.html#regression-table-and-inference"><i class="fa fa-check"></i><b>9.3.3</b> Regression table and inference</a></li>
<li class="chapter" data-level="9.3.4" data-path="regression-linear.html"><a href="regression-linear.html#prediction"><i class="fa fa-check"></i><b>9.3.4</b> Prediction</a></li>
<li class="chapter" data-level="9.3.5" data-path="regression-linear.html"><a href="regression-linear.html#diagnostics"><i class="fa fa-check"></i><b>9.3.5</b> Diagnostics</a></li>
<li class="chapter" data-level="9.3.6" data-path="regression-linear.html"><a href="regression-linear.html#binary-predictor-and-dummy-coding"><i class="fa fa-check"></i><b>9.3.6</b> Binary predictor and dummy coding</a></li>
<li class="chapter" data-level="9.3.7" data-path="regression-linear.html"><a href="regression-linear.html#nicer-regression-tables"><i class="fa fa-check"></i><b>9.3.7</b> Nicer regression tables</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="regression-linear.html"><a href="regression-linear.html#multiple-linear-regression"><i class="fa fa-check"></i><b>9.4</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="regression-linear.html"><a href="regression-linear.html#multiple-predictors"><i class="fa fa-check"></i><b>9.4.1</b> Multiple predictors</a></li>
<li class="chapter" data-level="9.4.2" data-path="regression-linear.html"><a href="regression-linear.html#categorical-predictors-with-2-levels"><i class="fa fa-check"></i><b>9.4.2</b> Categorical predictors with <span class="math inline">\(&gt;\)</span> 2 levels</a></li>
<li class="chapter" data-level="9.4.3" data-path="regression-linear.html"><a href="regression-linear.html#interactions"><i class="fa fa-check"></i><b>9.4.3</b> Interactions</a></li>
<li class="chapter" data-level="9.4.4" data-path="regression-linear.html"><a href="regression-linear.html#splines"><i class="fa fa-check"></i><b>9.4.4</b> Splines</a></li>
<li class="chapter" data-level="9.4.5" data-path="regression-linear.html"><a href="regression-linear.html#model-comparisons"><i class="fa fa-check"></i><b>9.4.5</b> Model comparisons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="regression-other.html"><a href="regression-other.html"><i class="fa fa-check"></i><b>10</b> More regression models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="regression-other.html"><a href="regression-other.html#logistic-regression"><i class="fa fa-check"></i><b>10.1</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="regression-other.html"><a href="regression-other.html#ex.-birthweight-uterine-irritability"><i class="fa fa-check"></i><b>10.1.1</b> Ex.: Birthweight &amp; uterine irritability</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="regression-other.html"><a href="regression-other.html#survival-regression"><i class="fa fa-check"></i><b>10.2</b> Survival regression</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="regression-other.html"><a href="regression-other.html#survival-data"><i class="fa fa-check"></i><b>10.2.1</b> Survival data</a></li>
<li class="chapter" data-level="10.2.2" data-path="regression-other.html"><a href="regression-other.html#survival-curves"><i class="fa fa-check"></i><b>10.2.2</b> Survival curves</a></li>
<li class="chapter" data-level="10.2.3" data-path="regression-other.html"><a href="regression-other.html#cox-regression"><i class="fa fa-check"></i><b>10.2.3</b> Cox regression</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="regression-other.html"><a href="regression-other.html#other-models"><i class="fa fa-check"></i><b>10.3</b> Other models</a></li>
</ul></li>
<li class="part"><span><b>IV Graphics</b></span></li>
<li class="chapter" data-level="11" data-path="graphics-base.html"><a href="graphics-base.html"><i class="fa fa-check"></i><b>11</b> Graphics in base R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="graphics-base.html"><a href="graphics-base.html#overview-5"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="graphics-base.html"><a href="graphics-base.html#base-plots-base-plots"><i class="fa fa-check"></i><b>11.2</b> Base plots</a></li>
<li class="chapter" data-level="11.3" data-path="graphics-base.html"><a href="graphics-base.html#graphical-parameters"><i class="fa fa-check"></i><b>11.3</b> Graphical parameters</a>
<ul>
<li class="chapter" data-level="" data-path="graphics-base.html"><a href="graphics-base.html#vectorized-graphical-parameters"><i class="fa fa-check"></i>Vectorized graphical parameters</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="graphics-base.html"><a href="graphics-base.html#graphical-devices"><i class="fa fa-check"></i><b>11.4</b> Displaying and saving plots</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="graphics-base.html"><a href="graphics-base.html#device-par"><i class="fa fa-check"></i><b>11.4.1</b> Controlling a device through <code>par</code></a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="graphics-base.html"><a href="graphics-base.html#high-low-plots"><i class="fa fa-check"></i><b>11.5</b> High- vs. low-level plotting</a></li>
<li class="chapter" data-level="11.6" data-path="graphics-base.html"><a href="graphics-base.html#using-colors"><i class="fa fa-check"></i><b>11.6</b> Using colors</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="graphics-base.html"><a href="graphics-base.html#specifying-colors-by-name"><i class="fa fa-check"></i><b>11.6.1</b> Specifying colors by name</a></li>
<li class="chapter" data-level="11.6.2" data-path="graphics-base.html"><a href="graphics-base.html#specifying-colors-mathematically"><i class="fa fa-check"></i><b>11.6.2</b> Specifying colors mathematically</a></li>
<li class="chapter" data-level="11.6.3" data-path="graphics-base.html"><a href="graphics-base.html#using-sets-of-colors-palettes"><i class="fa fa-check"></i><b>11.6.3</b> Using sets of colors: palettes</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="graphics-base.html"><a href="graphics-base.html#next-steps-2"><i class="fa fa-check"></i><b>11.7</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html"><i class="fa fa-check"></i><b>12</b> ggplot2: an alternative plotting system</a>
<ul>
<li class="chapter" data-level="12.1" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#introduction-1"><i class="fa fa-check"></i><b>12.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#concepts-basic-usage"><i class="fa fa-check"></i><b>12.1.1</b> Concepts &amp; basic usage</a></li>
<li class="chapter" data-level="12.1.2" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#practicalities"><i class="fa fa-check"></i><b>12.1.2</b> Practicalities</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#more-about-aesthetics-and-geoms"><i class="fa fa-check"></i><b>12.2</b> More about aesthetics and geoms</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#optional-aesthetics"><i class="fa fa-check"></i><b>12.2.1</b> Optional aesthetics</a></li>
<li class="chapter" data-level="12.2.2" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#multiple-geoms"><i class="fa fa-check"></i><b>12.2.2</b> Multiple geoms</a></li>
<li class="chapter" data-level="12.2.3" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#using-geom-arguments"><i class="fa fa-check"></i><b>12.2.3</b> Using geom arguments</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#splitting-plots-by-sub-groups"><i class="fa fa-check"></i><b>12.3</b> Splitting plots by sub-groups</a></li>
<li class="chapter" data-level="12.4" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#changing-the-default-appearance"><i class="fa fa-check"></i><b>12.4</b> Changing the default appearance</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#scales"><i class="fa fa-check"></i><b>12.4.1</b> Scales</a></li>
<li class="chapter" data-level="12.4.2" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#fixing-aesthetics"><i class="fa fa-check"></i><b>12.4.2</b> Fixing aesthetics</a></li>
<li class="chapter" data-level="12.4.3" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#themes"><i class="fa fa-check"></i><b>12.4.3</b> Themes</a></li>
<li class="chapter" data-level="12.4.4" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#other"><i class="fa fa-check"></i><b>12.4.4</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#complex-layering-and-annotation"><i class="fa fa-check"></i><b>12.5</b> Complex layering and annotation</a></li>
<li class="chapter" data-level="12.6" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#extensions"><i class="fa fa-check"></i><b>12.6</b> Extensions</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#assemble-multi-panel-plots-patchwork"><i class="fa fa-check"></i><b>12.6.1</b> Assemble multi-panel plots: patchwork</a></li>
<li class="chapter" data-level="12.6.2" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#others"><i class="fa fa-check"></i><b>12.6.2</b> Others</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="graphics-ggplot2.html"><a href="graphics-ggplot2.html#next-steps-3"><i class="fa fa-check"></i><b>12.7</b> Next steps</a></li>
</ul></li>
<li class="part"><span><b>V Organizing the analysis</b></span></li>
<li class="chapter" data-level="13" data-path="tables-nice.html"><a href="tables-nice.html"><i class="fa fa-check"></i><b>13</b> Generating nice tables</a></li>
<li class="chapter" data-level="14" data-path="dynamic-documents.html"><a href="dynamic-documents.html"><i class="fa fa-check"></i><b>14</b> Dynamic documents</a></li>
<li class="chapter" data-level="15" data-path="scripting-workflow.html"><a href="scripting-workflow.html"><i class="fa fa-check"></i><b>15</b> Scripting and workflow</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphics-base" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">11</span> Graphics in base R<a href="graphics-base.html#graphics-base" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="overview-5" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Overview<a href="graphics-base.html#overview-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, we will look at the plotting functions that are available in R by default. These <em>base graphics</em> or <em>base plots</em> are what we have used so far in the previous chapters: while not especially fancy, they generally get the job done (i.e. visualize the data or results), and are well-integrated in the R language. Here, we will</p>
<ul>
<li>introduce more examples for plots,</li>
<li>demonstrate how the appearance of base plots can be modified to include different colors, symbols, labels etc.</li>
<li>demonstrate how to build a custom plot from scratch,</li>
<li>look at available color definitions and -schemes,</li>
<li>display plots, and save them directly to a file, without having to use the RStudio GUI.</li>
</ul>
<p>The data example for this chapter is a subset of the Harvest cohort, which contains data on individuals with low or pre-hypertension: systolic and diastolic blood pressure as primary outcomes, with relevant demographic and lifestyle covariates, namely age, sex, BMI, smoking status, physical activity level and resting heart rate<a href="#fn59" class="footnote-ref" id="fnref59"><sup>59</sup></a>.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="graphics-base.html#cb242-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">load</span>(<span class="st">&quot;Data/Harvest.RData&quot;</span>)</span>
<span id="cb242-2"><a href="graphics-base.html#cb242-2" tabindex="-1"></a><span class="sc">&gt;</span> Harvest[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ]</span>
<span id="cb242-3"><a href="graphics-base.html#cb242-3" tabindex="-1"></a>  Age Sex  BMI  Sport Smoking SystBP DiaBP  HR</span>
<span id="cb242-4"><a href="graphics-base.html#cb242-4" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">24</span>   M <span class="fl">22.7</span>   None      no    <span class="dv">152</span>    <span class="dv">98</span>  <span class="dv">81</span></span>
<span id="cb242-5"><a href="graphics-base.html#cb242-5" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">42</span>   F <span class="fl">26.6</span> Medium     yes    <span class="dv">153</span>    <span class="dv">96</span> <span class="dv">100</span></span>
<span id="cb242-6"><a href="graphics-base.html#cb242-6" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">28</span>   F <span class="fl">22.3</span>   None     yes    <span class="dv">149</span>   <span class="dv">104</span>  <span class="dv">73</span></span>
<span id="cb242-7"><a href="graphics-base.html#cb242-7" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">44</span>   M <span class="fl">24.0</span> Medium      no    <span class="dv">149</span>    <span class="dv">92</span>  <span class="dv">74</span></span>
<span id="cb242-8"><a href="graphics-base.html#cb242-8" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">36</span>   F <span class="fl">22.2</span> Medium      no    <span class="dv">158</span>   <span class="dv">105</span>  <span class="dv">73</span></span></code></pre></div>
</div>
<div id="base-plots-base-plots" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Base plots<a href="graphics-base.html#base-plots-base-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The original concepts and technology underlying base plots are old, going back to the 1990s, when plotting was still a non-trivial effort, and have grown organically over time, rather than being developed systematically. As a consequence, base plots tend to look somewhat old-fashioned, and the defaults make little use of colors and annotation. However, the system is built to be flexible, and you can add as much color and annotation as you like – however, this can be complicated and may require knowledge about R internal affairs.</p>
<p>Both user interface and appearance of the R base system and its extensions are often inconsistent. For example, when we compare a histogram and a boxplot of the same data generated with the functions <code>hist</code> and <code>boxplot</code> that we have used before, we see that the histogram has an informative title, axis labels, and no box around the plot; in contrast, the boxplot has no title and no axis labels, but the plotting area is surrounded by a box.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="graphics-base.html#cb243-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">hist</span>(Harvest<span class="sc">$</span>Age)</span>
<span id="cb243-2"><a href="graphics-base.html#cb243-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">boxplot</span>(Harvest<span class="sc">$</span>BMI)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-254-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Base plot functions can be applied not just to raw data, but also to data summaries: we have already seen the function <code>barplot</code> for tabulated frequencies; we can also do density plots, a fancy version of a histogram where we estimate the density curve and plot it: the distribution here seems reasonably symmetric, with a center at or just under 150.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="graphics-base.html#cb244-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">barplot</span>(<span class="fu">table</span>(Harvest<span class="sc">$</span>Sport))</span>
<span id="cb244-2"><a href="graphics-base.html#cb244-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(<span class="fu">density</span>(Harvest<span class="sc">$</span>SystBP))</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-255-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We have already seen scatterplots for of two variables in Section <a href="regression-linear.html#scatter-loess">9.3.1</a>, both the basic variant using the formula notation, which has nice axis labels, and the smoothed version, which is a different function, with a different user interface, and not so nice labels.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="graphics-base.html#cb245-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(BMI <span class="sc">~</span> Age, Harvest)</span>
<span id="cb245-2"><a href="graphics-base.html#cb245-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">scatter.smooth</span>(Harvest<span class="sc">$</span>Age, Harvest<span class="sc">$</span>BMI)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-256-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>There are also plots function specifically for multivariate data: <code>pairs</code> takes a data frame of numerical variables, and produces all pair-wise scatterplots, arranged as a table. Below, we see age, BMI, blood pressure and heart rate, all plotted against each other; note that the plots above and below the diagonal show the same variables, just with reversed x- and y-axis; for our exapmple here, this is not very informative: because there are too many data points, we cannot see much due to overplotting.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="graphics-base.html#cb246-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">pairs</span>(Harvest[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>)])</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-257-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>An interesting variant of showing multiple scatterplots in the same graphic is the <em>conditioning plot</em>, which allows us to show scatterplots of two variables for different values of one or multiple conditioning variables. We use the formula interface for function <code>coplot</code> a plot of BMI against age, separately for each sex</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="graphics-base.html#cb247-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">coplot</span>(BMI <span class="sc">~</span> Age <span class="sc">|</span> Sex, Harvest)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-258-1.png" width="80%" style="display: block; margin: auto;" />
Both <code>pairs</code> and <code>coplot</code> are versatile, but require quite some effort to unlock that versatility<a href="#fn60" class="footnote-ref" id="fnref60"><sup>60</sup></a></p>
<p>Table <a href="graphics-base.html#tab:baseplots">11.1</a> lists some examples of plots that are available “out of the box”, i.e. when starting an ordinary R session with default packages attached; below, we show some applications to our current example data.</p>
<table>
<caption><span id="tab:baseplots">Table 11.1: </span> Examples of base plotting functions in default packages <code>graphics</code> and <code>stats</code></caption>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>assocplot</td>
<td>Deviations from independence in a frequency table</td>
</tr>
<tr class="even">
<td>barplot</td>
<td>Barplot of frequencies</td>
</tr>
<tr class="odd">
<td>boxplot</td>
<td>Box-and-whisker plot</td>
</tr>
<tr class="even">
<td>cdplot</td>
<td>Conditional density plot</td>
</tr>
<tr class="odd">
<td>coplot</td>
<td>Conditional (scatter-) plot</td>
</tr>
<tr class="even">
<td>heatmap</td>
<td>Heatmap with dendrograms</td>
</tr>
<tr class="odd">
<td>matplot</td>
<td>Scatterplot of matrix columns</td>
</tr>
<tr class="even">
<td>mosaicplot</td>
<td>Proportions in a frequency table</td>
</tr>
<tr class="odd">
<td>plot.default</td>
<td>Scatterplot</td>
</tr>
<tr class="even">
<td>spineplot</td>
<td>Generalized barplot/histogram</td>
</tr>
<tr class="odd">
<td>smoothScatter</td>
<td>Smoothed high-density scatterplot</td>
</tr>
<tr class="even">
<td>interaction.plot</td>
<td>Means by 2-way grouping</td>
</tr>
<tr class="odd">
<td>qqplot</td>
<td>General quantile plot</td>
</tr>
<tr class="even">
<td>qqnorm</td>
<td>Normal quantile plot</td>
</tr>
<tr class="odd">
<td>termplot</td>
<td>Fitted model term (polynomial, spline)</td>
</tr>
</tbody>
</table>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-259-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="graphical-parameters" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Graphical parameters<a href="graphics-base.html#graphical-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As you would expect at this point, the default appearance of base plots can be modified via appropriate arguments to the corresponding plotting functions. These arguments are also referred to as <em>graphical parameters</em>.</p>
<p>For example, the standard <code>plot</code>-function has arguments <code>main</code>, <code>xlab</code> and <code>ylab</code> that can be used to specify an informative plot title and axis labels:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="graphics-base.html#cb248-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(BMI <span class="sc">~</span> Age, Harvest, <span class="at">main =</span> <span class="st">&quot;Harvest&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Age [years]&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;BMI [kg/m^2]&quot;</span>)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-260-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We can also change the symbol that is plotted at each (x,y)-location, as well as its color and size, via arguments <code>pch</code> (for plotting character), <code>col</code> and <code>cex</code> (for character expansion); if we want to, say, mark each measurement of age and BMI with a half-sized X in blue, we can specify</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="graphics-base.html#cb249-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(BMI <span class="sc">~</span> Age, Harvest, <span class="at">pch =</span> <span class="st">&quot;X&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-261-1.png" width="80%" style="display: block; margin: auto;" />
A different look… not a great look, but different.</p>
<p>Common graphical parameters like <code>main</code> and <code>col</code> are almost universally supported by base plotting functions, though their exact meaning will differ according to plot type (e.g. <code>col</code> affects <code>boxplot</code> differently than a scatterplot). More specialized parameters like <code>pch</code> will not always make sense (e.g. in a barplot). When in doubt, refer to the documentation for the corresponding plotting function.</p>
<div id="vectorized-graphical-parameters" class="section level3 unnumbered hasAnchor">
<h3>Vectorized graphical parameters<a href="graphics-base.html#vectorized-graphical-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Graphical parameters like <code>col</code>, <code>pch</code> and <code>cex</code> can often be <em>vectorized</em>: this means we can specify a whole vector of colors, symbols etc., which can be a very convenient way of highlighting subsets of data.</p>
<p>Let’s say that in our scatterplot example from above, we want to use different colors to indicate the sex of a participant. We can use the function <code>ifelse</code> to generate a suitable vector of colors: based on the values of the logical expression <code>Harvest$Sex == "M"</code>, it will return <code>"red"</code> if the participant is male, and <code>"blue"</code> otherwise<a href="#fn61" class="footnote-ref" id="fnref61"><sup>61</sup></a>. The results is saved as vector <code>mycol</code>, with one element for each row of <code>Harvest</code>:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="graphics-base.html#cb250-1" tabindex="-1"></a><span class="sc">&gt;</span> mycol <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Harvest<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">&quot;M&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb250-2"><a href="graphics-base.html#cb250-2" tabindex="-1"></a><span class="sc">&gt;</span> Harvest<span class="sc">$</span>Sex[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb250-3"><a href="graphics-base.html#cb250-3" tabindex="-1"></a>[<span class="dv">1</span>] M F F M F</span>
<span id="cb250-4"><a href="graphics-base.html#cb250-4" tabindex="-1"></a>Levels<span class="sc">:</span> F M</span>
<span id="cb250-5"><a href="graphics-base.html#cb250-5" tabindex="-1"></a><span class="sc">&gt;</span> mycol[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb250-6"><a href="graphics-base.html#cb250-6" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;red&quot;</span>  <span class="st">&quot;blue&quot;</span> <span class="st">&quot;blue&quot;</span> <span class="st">&quot;red&quot;</span>  <span class="st">&quot;blue&quot;</span></span></code></pre></div>
<p>This works as intended:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="graphics-base.html#cb251-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">table</span>(mycol, Harvest<span class="sc">$</span>Sex)</span>
<span id="cb251-2"><a href="graphics-base.html#cb251-2" tabindex="-1"></a>      </span>
<span id="cb251-3"><a href="graphics-base.html#cb251-3" tabindex="-1"></a>mycol    F   M</span>
<span id="cb251-4"><a href="graphics-base.html#cb251-4" tabindex="-1"></a>  blue <span class="dv">306</span>   <span class="dv">0</span></span>
<span id="cb251-5"><a href="graphics-base.html#cb251-5" tabindex="-1"></a>  red    <span class="dv">0</span> <span class="dv">794</span></span></code></pre></div>
<p>In the same way, we can set a different plotting symbol to indicate the smoking status of a participant:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="graphics-base.html#cb252-1" tabindex="-1"></a><span class="sc">&gt;</span> mypch <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Harvest<span class="sc">$</span>Smoking <span class="sc">==</span> <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;o&quot;</span>)</span>
<span id="cb252-2"><a href="graphics-base.html#cb252-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">table</span>(mypch, Harvest<span class="sc">$</span>Smoking)</span>
<span id="cb252-3"><a href="graphics-base.html#cb252-3" tabindex="-1"></a>     </span>
<span id="cb252-4"><a href="graphics-base.html#cb252-4" tabindex="-1"></a>mypch  no yes</span>
<span id="cb252-5"><a href="graphics-base.html#cb252-5" tabindex="-1"></a>    o <span class="dv">867</span>   <span class="dv">0</span></span>
<span id="cb252-6"><a href="graphics-base.html#cb252-6" tabindex="-1"></a>    x   <span class="dv">0</span> <span class="dv">229</span></span></code></pre></div>
<p>We can now feed these vectors of colors and symbols into the <code>plot</code>-function, using arguments <code>col</code> and <code>pch</code>:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="graphics-base.html#cb253-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(BMI <span class="sc">~</span> Age, Harvest, <span class="at">col =</span> mycol, <span class="at">pch =</span> mypch)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-265-1.png" width="80%" style="display: block; margin: auto;" />
Again, not exactly pretty, due questionable aesthetic choices on my part, but we have managed to encode information on two extra variables, namely sex and smoking status, in the scatterplot of age and BMI.</p>
<p>For a reasonably complex plot like this, a legend explaining what the different symbols and colors indicate is not really optional. As you will have guessed at this point, there’s a function for that, and it is called <code>legend</code>:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="graphics-base.html#cb254-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(BMI <span class="sc">~</span> Age, Harvest, <span class="at">col =</span> mycol, <span class="at">pch =</span> mypch)</span>
<span id="cb254-2"><a href="graphics-base.html#cb254-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Male smoker&quot;</span>, <span class="st">&quot;Female smoker&quot;</span>, <span class="st">&quot;Male non-smoker&quot;</span>, <span class="st">&quot;Female non-smoker&quot;</span>), <span class="at">col =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,</span>
<span id="cb254-3"><a href="graphics-base.html#cb254-3" tabindex="-1"></a><span class="sc">+</span>     <span class="st">&quot;red&quot;</span>), <span class="dv">2</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;o&quot;</span>), <span class="at">cex =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-266-1.png" width="80%" style="display: block; margin: auto;" />
We specify the position of the legend in the plot, the text to be displayed, as well as the colors and symbols that the text describes (good use of function <code>rep</code> for saving some typing with the colors); argument <code>cex</code> here does not encode any information (though it could!), but only makes the legend about 25% smaller.</p>
</div>
</div>
<div id="graphical-devices" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Displaying and saving plots<a href="graphics-base.html#graphical-devices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, we have not been overly concerned with <em>where</em> the plots we generate appear: in base R, a separate plotting window magically appears (Section <a href="introduction.html#ex-simple-plots">2.3.2</a>), and in RStudio, the Plots-tab handles all plot-related activities (Section <a href="intro_rstudio.html#def-lower-pane">3.2.5</a>). These are parts of the graphical user interface, and while they are convenient in interactive analysis, we seem to have little control over them so far.</p>
<p>Similar for saving plots to files: again, the right-click context menu of the base R plotting window and the Export-button of the RStudio Plots-tab offer basic functionality, but we have only limited control over how the plot will be transferred from the GUI to a file, and the appearance of these saved plots is often not that great (okay for an informal report, but generally not good enough for something more polished).</p>
<p>The concept that unifies display of graphics in R/RStudio and saving graphics to a file is that of a <em>graphical device</em>. Such a device is a container that can accept instructions from plotting functions to add graphical elements like lines, dots, axes, text etc. to an empty canvas (plotting area). From R’s point of view, it does not matter what the device does, just that it will accept plotting instructions. However:</p>
<ul>
<li><p>an <em>interactive device</em> like the plotting window in R, or the Plots-tab in RStudio, will draw the graphical elements onscreen for visual inspection,</p></li>
<li><p>a <em>file device</em> will translate the graphical instructions into a specified format and save the result to a file, which can then be copied, shared, imported into other software etc.</p></li>
</ul>
<p><strong>Interactive devices</strong> are generally handled quite smoothly by R/RStudio: e.g. if no device is active, either directly after starting the program, or because you have closed the previously active plotting window, any of the plotting functions discussed so far will simply start a new device/plotting window, without you having to do anything (though see Section <a href="graphics-base.html#high-low-plots">11.5</a> below)<a href="#fn62" class="footnote-ref" id="fnref62"><sup>62</sup></a>.</p>
<p><strong>File devices</strong> are not handled automagically, but they work with the same logic: first you <em>open</em> the device using a suitable function, then create your intended plot(s) exactly as you would have interactively, and once you are done, <em>close</em> the device. For example, we use the function <code>jpeg</code> to open a file device of type JPEG named <code>myplot.jpg</code> in the current working directory, create a variant of our example scatterplot, then we close the device:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="graphics-base.html#cb256-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">jpeg</span>(<span class="st">&quot;myplot.jpg&quot;</span>)</span>
<span id="cb256-2"><a href="graphics-base.html#cb256-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(BMI <span class="sc">~</span> Age, Harvest, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">main =</span> <span class="st">&quot;Harvest BMI vs Age&quot;</span>)</span>
<span id="cb256-3"><a href="graphics-base.html#cb256-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">dev.off</span>()</span></code></pre></div>
<p>Once you have closed the device, the resulting file can be viewed, inserted, edited etc. like any other image file<a href="#fn63" class="footnote-ref" id="fnref63"><sup>63</sup></a>.</p>
<p>There are numerous different file devices available, corresponding to different graphical formats, both for raster formats like JPEG or PNG, and for vector formats like SVG (or PDF)<a href="#fn64" class="footnote-ref" id="fnref64"><sup>64</sup></a>. The functions for opening them have generally have the same name as the format, see e.g. <code>?png</code> or <code>?svg</code>.</p>
<p>There are two advantages of using file devices directly instead of using the GUI export options:</p>
<ol style="list-style-type: decimal">
<li><p>You can create and save plots in a script directly, instead of using a script to generate a plot and then saving it manually. This allows for a fully scripted workflow to generate your results including any number of plots.</p></li>
<li><p>You can control the appearance and quality of your plots in terms of plot size, resolution, background color, font size etc. via arguments to the device functions.</p></li>
</ol>
<p>For example, if you look at the file <code>myplot.jpg</code> generated in the previous code snippet, you will see that the text labels appear a bit fuzzy, and the font size is small compared to the rest of the plot. To address this, I can increase the resolution of the plot file to 300 dpi, the quality to 100% (i.e. lossless compression), and change the overall plot to size 12.5 cm cm (suitable for e.g. inclusion on an A4 page):</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="graphics-base.html#cb257-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">jpeg</span>(<span class="st">&quot;myplot2.jpg&quot;</span>, <span class="at">width =</span> <span class="fl">12.5</span>, <span class="at">height =</span> <span class="fl">12.5</span>, <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="at">res =</span> <span class="dv">300</span>, <span class="at">quality =</span> <span class="dv">100</span>)</span>
<span id="cb257-2"><a href="graphics-base.html#cb257-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(BMI <span class="sc">~</span> Age, Harvest, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">main =</span> <span class="st">&quot;Harvest BMI vs Age&quot;</span>)</span>
<span id="cb257-3"><a href="graphics-base.html#cb257-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">dev.off</span>()</span></code></pre></div>
<p>If you open the new file in a viewer, it will be crisper, and the size of the labels is more proportional to the overall plot size, too.</p>
<p>Of course, there is a price to pay for this: if we look at all <code>.jpg</code> files in the current working directory, and their file sizes (in bytes), we see that the crisper version is more than ten times bigger, which may or may not be acceptable.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="graphics-base.html#cb258-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">dir</span>(<span class="at">pattern =</span> <span class="st">&quot;*.jpg&quot;</span>)</span>
<span id="cb258-2"><a href="graphics-base.html#cb258-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;myplot.jpg&quot;</span>  <span class="st">&quot;myplot2.jpg&quot;</span></span>
<span id="cb258-3"><a href="graphics-base.html#cb258-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">file.size</span>(<span class="fu">dir</span>(<span class="at">pattern =</span> <span class="st">&quot;*.jpg&quot;</span>))</span>
<span id="cb258-4"><a href="graphics-base.html#cb258-4" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="dv">33384</span> <span class="dv">423753</span></span></code></pre></div>
<div id="device-par" class="section level3 hasAnchor" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> Controlling a device through <code>par</code><a href="graphics-base.html#device-par" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have already seen how graphical parameters passed as arguments to a plotting function can effect the appearance of a plot. However, we can also set graphical parameters directly for the current graphical device using the function <code>par</code>: in this case, the parameter value becomes the new default for the current device for all subsequent plots, until either the device is closed or the parameter is changed again via <code>par</code><a href="#fn65" class="footnote-ref" id="fnref65"><sup>65</sup></a>. For example, if we set the plotting character as <code>pch=19</code> as above, but using <code>par</code>, all subsequent plots will use a small solid dot as plotting character:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="graphics-base.html#cb259-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">par</span>(<span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb259-2"><a href="graphics-base.html#cb259-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(BMI <span class="sc">~</span> Age, Harvest)</span>
<span id="cb259-3"><a href="graphics-base.html#cb259-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(BMI <span class="sc">~</span> Sex, Harvest)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-270-1.png" width="80%" style="display: block; margin: auto;" />
If we want to change the plotting symbol back to the default open circle, we can either call <code>par</code> again as <code>par(pch="o")</code>, or close the device and open a new one<a href="#fn66" class="footnote-ref" id="fnref66"><sup>66</sup></a>.</p>
<p><code>par</code> is extremely powerful: there is a total of <span class="math inline">\(n = 72\)</span> different graphical parameters, of which <span class="math inline">\(n = 66\)</span> can be modified by the user to affect the look of a plot<a href="#fn67" class="footnote-ref" id="fnref67"><sup>67</sup></a>; you can use it to e.g.</p>
<ul>
<li>change the size, color and font of titles, labels and axes (<code>cex.*</code>, <code>col.*</code>, <code>font.*</code>/<code>family</code>),</li>
<li>change the type and scaling of plot axes (<code>xaxp</code>/<code>yaxp</code>, <code>xaxs</code>/<code>yaxs</code>, <code>xaxt</code>/<code>yaxt</code>, <code>xlog</code>/<code>ylog</code>),</li>
<li>change inner and outer margins surrounding the plot area (<code>mar</code>/<code>mai</code>, <code>oma</code>/<code>omi</code>),</li>
<li>split up the plotting are into multiple subplots (<code>mfrow</code>/<code>mfcol</code>).</li>
</ul>
<p>Generally, you neither want nor need to control plots at this detailed level, so this is mostly FYI, though splitting up the plotting area into separate panels can be often useful: both <code>mfrow</code> and <code>mfcol</code> accept as argument a vector of two positive integers that indicate into how many rows (first element) and columns (second element) the current device should be split. For example, if we want to put two plots side by side, this corresponds to a grid of 1 <span class="math inline">\(\times\)</span> 2 panels, which can be specified as</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="graphics-base.html#cb261-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb261-2"><a href="graphics-base.html#cb261-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">scatter.smooth</span>(Harvest<span class="sc">$</span>Age, Harvest<span class="sc">$</span>BMI, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb261-3"><a href="graphics-base.html#cb261-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">hist</span>(Harvest<span class="sc">$</span>Age)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-271-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>If you are interested in fine-tuning graphical displays of data, the documentation for <code>par</code> is essential reading for understanding the technical details of the base graphics system. However, if you are new to R, I suggest that you have a look at Section <a href="graphics-ggplot2.html#graphics-ggplot2">12</a> first, where we discuss the graphics system implemented by package <code>ggplot2</code>, before you go down the rabbit hole that the base graphics system can be.</p>
</div>
</div>
<div id="high-low-plots" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> High- vs. low-level plotting<a href="graphics-base.html#high-low-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Base plotting functions can be roughly classified as high-level and low-level:</p>
<ul>
<li><p><em>High-level</em> plotting functions visualize data: they accept either raw data or statistical results as main input, often specified via a formula interface, and generally start a new plot/device when called. Examples we have seen are <code>boxplot</code>, <code>hist</code> and all functions listed in Table <a href="graphics-base.html#tab:baseplots">11.1</a>.</p></li>
<li><p><em>Low-level</em> plotting functions generally add graphical elements to an existing plot; while they sometimes accept data as input, they are more often built around graphical parameters as seen e.g. in Section <a href="graphics-base.html#device-par">11.4.1</a>. Examples are <code>legend</code>, <code>abline</code>, <code>title</code>, <code>points</code>, <code>segments</code> etc.</p></li>
</ul>
<p>The idea is that high-level functions allow specification of a plot to answer a question about the data, in terms of a specific visualization task: e.g. “I want to see the distribution of BMI in the Harvest data; draw an informative histogram” - this can be done without reference to the base graphical system. So theoretically, we could just live off the rich set of high-level functions with default setting - however, if we want to produce something more polished for publication, we often need to understand details of the underlying graphical parameters, either as argument to the high-level function itself (e.g. <code>pch</code> for <code>plot</code>) or via a low-level function that adds to the high-level plot (e.g. <code>legend</code>.)</p>
<p>Internally, high-level functions are generally assembled from calls to low-level functions; let’s demonstrate this by building a modified scatterplot of BMI vs age below. This consists of multiple steps:</p>
<ol style="list-style-type: decimal">
<li>Set up an empty plot: call the <code>plot</code>-function to set up a new plot, but use graphical parameters suppress all output (no data points, no axes etc.)</li>
<li>Add the plot axes via calls to <code>axis</code>.</li>
<li>Add a box around the plotting area between the axes.</li>
<li>Add a title and axis labels.</li>
<li>Add the actual data points to the scatter plot via function <code>points</code>.</li>
<li>Add a loess smoother the hard way, by calculating a smoothed curve as a set of x- and y-coordinates, and adding that curve via function <code>lines</code>.</li>
</ol>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="graphics-base.html#cb262-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># We start from scratch: this only sets up an empty plot</span></span>
<span id="cb262-2"><a href="graphics-base.html#cb262-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">plot</span>(BMI <span class="sc">~</span> Age, Harvest, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">yaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-272-1.png" width="350px" height="250px" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="graphics-base.html#cb263-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Axes</span></span>
<span id="cb263-2"><a href="graphics-base.html#cb263-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">axis</span>(<span class="dv">1</span>)  <span class="co"># x-axis</span></span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-272-2.png" width="350px" height="250px" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="graphics-base.html#cb264-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">axis</span>(<span class="dv">2</span>)  <span class="co"># y-axis</span></span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-272-3.png" width="350px" height="250px" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="graphics-base.html#cb265-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Box around plot area</span></span>
<span id="cb265-2"><a href="graphics-base.html#cb265-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">box</span>()</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-272-4.png" width="350px" height="250px" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="graphics-base.html#cb266-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Use title-function to axis labels</span></span>
<span id="cb266-2"><a href="graphics-base.html#cb266-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">title</span>(<span class="at">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;BMI&quot;</span>)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-272-5.png" width="350px" height="250px" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="graphics-base.html#cb267-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Now add the data</span></span>
<span id="cb267-2"><a href="graphics-base.html#cb267-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">points</span>(Harvest<span class="sc">$</span>Age, Harvest<span class="sc">$</span>BMI, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-272-6.png" width="350px" height="250px" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="graphics-base.html#cb268-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Fit the loess smoother &amp; add it to plot Exclude missing values</span></span>
<span id="cb268-2"><a href="graphics-base.html#cb268-2" tabindex="-1"></a><span class="er">&gt;</span> ndx <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(Harvest<span class="sc">$</span>Age) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Harvest<span class="sc">$</span>BMI)</span>
<span id="cb268-3"><a href="graphics-base.html#cb268-3" tabindex="-1"></a><span class="sc">&gt;</span> smooth <span class="ot">&lt;-</span> <span class="fu">lowess</span>(Harvest<span class="sc">$</span>Age[ndx], Harvest<span class="sc">$</span>BMI[ndx])</span>
<span id="cb268-4"><a href="graphics-base.html#cb268-4" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">str</span>(smooth)  <span class="co"># Simple list with x- and y-coordinates</span></span>
<span id="cb268-5"><a href="graphics-base.html#cb268-5" tabindex="-1"></a>List of <span class="dv">2</span></span>
<span id="cb268-6"><a href="graphics-base.html#cb268-6" tabindex="-1"></a> <span class="sc">$</span> x<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">1058</span>] <span class="dv">14</span> <span class="dv">16</span> <span class="dv">16</span> <span class="dv">16</span> <span class="dv">16</span> <span class="dv">17</span> <span class="dv">17</span> <span class="dv">17</span> <span class="dv">17</span> <span class="dv">17</span> ...</span>
<span id="cb268-7"><a href="graphics-base.html#cb268-7" tabindex="-1"></a> <span class="sc">$</span> y<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">1058</span>] <span class="fl">23.5</span> <span class="fl">23.6</span> <span class="fl">23.6</span> <span class="fl">23.6</span> <span class="fl">23.6</span> ...</span>
<span id="cb268-8"><a href="graphics-base.html#cb268-8" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">lines</span>(smooth)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-272-7.png" width="350px" height="250px" style="display: block; margin: auto;" />
Note that this incremental build of a plot gives us a lot of control at each step: e.g. we can choose to puxt axes at the top and right of the plot, instead or in addition to at the bottom / left, or we can limit the range of the data where we want to plot the smoothing curve.</p>
<p><strong>Exercise:</strong> Have a look at the first example plot in Section @{base-plots-base-plots}, where the differences between the appearance of the default histogram and boxplot are highlighted; using low-level plotting functions. Re-create the side-by-side plot seen there, but make the appearance of the two plots as similar as possible.</p>
</div>
<div id="using-colors" class="section level2 hasAnchor" number="11.6">
<h2><span class="header-section-number">11.6</span> Using colors<a href="graphics-base.html#using-colors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="specifying-colors-by-name" class="section level3 hasAnchor" number="11.6.1">
<h3><span class="header-section-number">11.6.1</span> Specifying colors by name<a href="graphics-base.html#specifying-colors-by-name" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have briefly seen the use of colors above for vectorized graphical parameters in Section <a href="graphics-base.html#graphical-parameters">11.3</a>, where we just stated the names of primary colors like <code>"red"</code> and <code>"blue"</code> as values for argument <code>col</code>. As you may have guessed, this also works for a range of other “obvious” color names:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="graphics-base.html#cb269-1" tabindex="-1"></a><span class="sc">&gt;</span> simple_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;brown&quot;</span>)</span>
<span id="cb269-2"><a href="graphics-base.html#cb269-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">show_colors</span>(simple_colors)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-274-1.png" width="400px" height="100px" style="display: block; margin: auto;" /></p>
<p>This is easy and intuitive to use, but may at first glance appear somewhat limited - but it is really not: depending on your operating system setup, R will understand several hundred different color names. For example, on the machine where this introduction is compiled, R understands 657 different color names, corresponding to 502$ distinct colors (some colors have more than one name).</p>
<p>This is a small random sample:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="graphics-base.html#cb270-1" tabindex="-1"></a><span class="sc">&gt;</span> example_colors <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">colors</span>(<span class="at">distinct =</span> <span class="cn">TRUE</span>), <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb270-2"><a href="graphics-base.html#cb270-2" tabindex="-1"></a><span class="sc">&gt;</span> example_colors</span>
<span id="cb270-3"><a href="graphics-base.html#cb270-3" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;maroon2&quot;</span>        <span class="st">&quot;gray31&quot;</span>         <span class="st">&quot;gold3&quot;</span>          <span class="st">&quot;royalblue&quot;</span>      <span class="st">&quot;tan1&quot;</span>          </span>
<span id="cb270-4"><a href="graphics-base.html#cb270-4" tabindex="-1"></a> [<span class="dv">6</span>] <span class="st">&quot;lightsalmon4&quot;</span>   <span class="st">&quot;lemonchiffon2&quot;</span>  <span class="st">&quot;steelblue1&quot;</span>     <span class="st">&quot;gray52&quot;</span>         <span class="st">&quot;lightslategray&quot;</span></span>
<span id="cb270-5"><a href="graphics-base.html#cb270-5" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">show_colors</span>(example_colors)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-275-1.png" width="600px" height="100px" style="display: block; margin: auto;" /></p>
<p>Of course, this leads directly to another problem: who can remember and distinguish hundreds of colors, many with names that are fancy rather than helpful (<em>bisque</em>), or neither fancy nor helpful (<em>white2</em>)? The next section shows a more systematic way of exploring the space of possible colors.</p>
<p><strong>Exercise:</strong> Re-do the scatterplot with vectorized graphical parameters from Section <a href="graphics-base.html#graphical-parameters">11.3</a>, using colors <em>chartreuse</em> and <em>hotpink</em>, including a legend. In your opinion, is this an aesthetic improvement?</p>
</div>
<div id="specifying-colors-mathematically" class="section level3 hasAnchor" number="11.6.2">
<h3><span class="header-section-number">11.6.2</span> Specifying colors mathematically<a href="graphics-base.html#specifying-colors-mathematically" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A more systematic approach to defining colors is via a <em>color model</em>, where each color is represented by a set of numbers. The classic example for this is the RGB color model<a href="#fn68" class="footnote-ref" id="fnref68"><sup>68</sup></a>, which mixes colors as a sum of a red, green and blue component. This color model is implemented in base
R via function <code>rgb</code>_: by default, the intensity of each component of the color model is specified as a number between zero and one, zero corresponding to zero intensity, and one to full intensity. For example, if we want to specify color that is mostly green, with some red and a dash of blue, we can use</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="graphics-base.html#cb271-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">rgb</span>(<span class="at">red =</span> <span class="fl">0.5</span>, <span class="at">green =</span> <span class="fl">0.75</span>, <span class="at">blue =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb271-2"><a href="graphics-base.html#cb271-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;#80BF4080&quot;</span></span></code></pre></div>
<p>The return value is a string encoding a hexadecimal number (indicated by the leading <code>#</code>) which can be used everywhere instead of the traditional color names described above (e.g. for argument <code>col</code>).</p>
<p>Note that above I have used an extra fourth argument <code>alpha</code>, which controls the transparency of the color, again with values between zero (completely transparent) to one (completely solid) - this can be useful in situations where we want to control overplotting; as a result, the hexadecimal string has eight hexadecimal digits, corresponding to eight bytes<a href="#fn69" class="footnote-ref" id="fnref69"><sup>69</sup></a>.</p>
<p>The string we see above corresponds to something I would call a <em>minty green</em>:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="graphics-base.html#cb272-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">show_colors</span>(<span class="fu">rgb</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-277-1.png" width="400px" height="100px" style="display: block; margin: auto;" />
On account of my somewhat divergent color perception, you may feel free to disagree with this characterization.</p>
<p>R supports a number of other color models (see e.g. <code>?hsv</code> and <code>?hcl</code>), but the short and the long of it is that we are not limited to a set of predefined colors with obscure names, bur can define whatever color we damn well please. The downside of this is of course that most of the time, we do not care <em>that</em> deeply about the exact shade of pink used in a plot, and while the hexadecimal codes are readable, they are still awkward; in other words, while color models are great for implementing the underlying plotting infrastructure, they are not all that commonly used on their own in actual data visualization.</p>
<p><strong>Excercise:</strong> Use the function <code>col2rgb</code> to verify</p>
<ol style="list-style-type: lower-alpha">
<li>that the primary colors <code>"red"</code>, <code>"blue"</code> and <code>"green"</code> in R deserve their names,</li>
<li>what exactly the difference is between colors <code>"gray52"</code> and <code>"lightslategray"</code> in our random sample of colors above.</li>
</ol>
</div>
<div id="using-sets-of-colors-palettes" class="section level3 hasAnchor" number="11.6.3">
<h3><span class="header-section-number">11.6.3</span> Using sets of colors: palettes<a href="graphics-base.html#using-sets-of-colors-palettes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So both color names and color models come with some drawbacks, as outlined above. The practical solution to these drawbacks is the use of pre-defined sets of colors, called <em>palettes</em> in R: in data visualization, we generally use color for contrast, e.g. between groups of data points, meaning we usually need to specify more than one color at a time; therefore, having an easy way of specifying a vector of colors of variable length makes life much easier than having to spell out a vector of color names or - codes manually.</p>
<p>A <em>palette function</em> takes as argument the number of different colors required, and returns a character vector of the specified length consisting of distinct color codes. For example, the function <code>heat.colors</code> returns a vector of colors on a heat spectrum, from red to white; if we want 12 colors along this spectrum, we just call</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="graphics-base.html#cb273-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">heat.colors</span>(<span class="dv">12</span>)</span>
<span id="cb273-2"><a href="graphics-base.html#cb273-2" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;#FF0000&quot;</span> <span class="st">&quot;#FF2000&quot;</span> <span class="st">&quot;#FF4000&quot;</span> <span class="st">&quot;#FF6000&quot;</span> <span class="st">&quot;#FF8000&quot;</span> <span class="st">&quot;#FF9F00&quot;</span> <span class="st">&quot;#FFBF00&quot;</span> <span class="st">&quot;#FFDF00&quot;</span> <span class="st">&quot;#FFFF00&quot;</span></span>
<span id="cb273-3"><a href="graphics-base.html#cb273-3" tabindex="-1"></a>[<span class="dv">10</span>] <span class="st">&quot;#FFFF2A&quot;</span> <span class="st">&quot;#FFFF80&quot;</span> <span class="st">&quot;#FFFFD5&quot;</span></span>
<span id="cb273-4"><a href="graphics-base.html#cb273-4" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">show_colors</span>(<span class="fu">heat.colors</span>(<span class="dv">12</span>))</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-278-1.png" width="400px" height="100px" style="display: block; margin: auto;" /></p>
<p>We can do this for as little as two colors, which turns out as red vs yellow, suitable for comparing two groups of data points, or 120 colors or more, which gives us a nice smooth transition useful e.g. for a heatmap; and if we add some transparency to the 120-color spread, we get nice peach tones:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="graphics-base.html#cb274-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">show_colors</span>(<span class="fu">heat.colors</span>(<span class="dv">2</span>))</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-279-1.png" width="400px" height="100px" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="graphics-base.html#cb275-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">show_colors</span>(<span class="fu">heat.colors</span>(<span class="dv">120</span>))</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-279-2.png" width="400px" height="100px" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="graphics-base.html#cb276-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">show_colors</span>(<span class="fu">heat.colors</span>(<span class="dv">120</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-279-3.png" width="400px" height="100px" style="display: block; margin: auto;" />
There a number of different palette functions available in base R, like e.g. <code>rainbow</code> and <code>topo.colors</code>, which provide the same service, just along different axes in the color space:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="graphics-base.html#cb277-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Rainbow</span></span>
<span id="cb277-2"><a href="graphics-base.html#cb277-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">show_colors</span>(<span class="fu">rainbow</span>(<span class="dv">12</span>))</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-280-1.png" width="400px" height="100px" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="graphics-base.html#cb278-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Topographic</span></span>
<span id="cb278-2"><a href="graphics-base.html#cb278-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">show_colors</span>(<span class="fu">topo.colors</span>(<span class="dv">12</span>))</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-280-2.png" width="400px" height="100px" style="display: block; margin: auto;" /></p>
<p>These traditional palettes are based on physical (heat, rainbow) or traditional (topgraphic maps) color schemes, and while intuitive, do not work equally well under all circumstances. A more modern set of palettes, which are designed for different uses cases, and have been empirically tested for for visual differentiation, are the <em>Brewer palettes</em><a href="#fn70" class="footnote-ref" id="fnref70"><sup>70</sup></a>. These are implemented in the R package <code>RColorBrewer</code>, which comes with a handy diaply function to show all its palettes:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="graphics-base.html#cb279-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(RColorBrewer)</span>
<span id="cb279-2"><a href="graphics-base.html#cb279-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">display.brewer.all</span>()</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-281-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note that in the display above, the palettes are shown in three distinct blocks, corresponding to three different types of palettes with different use cases:</p>
<ul>
<li><p>At the top, we see <em>sequential</em> palettes, which are designed to display a gradient across groups, from lowest to highest; these palettes are most useful for displaying ordinal variables, e.g. age categories or BMI weight status.</p></li>
<li><p>In the middle, we see <em>qualitative</em> palettes, which are designed to show differences between distinct groups that have no special ordering; these palettes are most use for visualizing nominal variable, e.g. county of residence or country of origin.</p></li>
<li><p>At the bottom, we see <em>divergent</em> palettes, which show deviations below or above a central reference value (often zero); these are most useful for showing differences of some kind, e.g. standardized variables, log odds ratios, or log fold changes.</p></li>
</ul>
<p>I especially appreciate about the Brewer palettes that they have a subset explicitly easier to process for color-impaired persons like myself:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="graphics-base.html#cb280-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">display.brewer.all</span>(<span class="at">colorblindFriendly =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-282-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Usage of the Brewer palettes is straightforward: after reflecting on the intended use case (sequential, qualitative, divergent), pick a palette function with an color scheme and a sufficient number of distinct levels, and generate the vector of colors. For example, here I have chosen an attractive diverging palette spanning from purple to green with 10 distinct levels:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="graphics-base.html#cb281-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">&quot;PRGn&quot;</span>, <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb281-2"><a href="graphics-base.html#cb281-2" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;#40004B&quot;</span> <span class="st">&quot;#762A83&quot;</span> <span class="st">&quot;#9970AB&quot;</span> <span class="st">&quot;#C2A5CF&quot;</span> <span class="st">&quot;#E7D4E8&quot;</span> <span class="st">&quot;#D9F0D3&quot;</span> <span class="st">&quot;#A6DBA0&quot;</span> <span class="st">&quot;#5AAE61&quot;</span> <span class="st">&quot;#1B7837&quot;</span></span>
<span id="cb281-3"><a href="graphics-base.html#cb281-3" tabindex="-1"></a>[<span class="dv">10</span>] <span class="st">&quot;#00441B&quot;</span></span>
<span id="cb281-4"><a href="graphics-base.html#cb281-4" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">display.brewer.pal</span>(<span class="at">name =</span> <span class="st">&quot;PRGn&quot;</span>, <span class="at">n =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="introductio-to-r_files/figure-html/unnamed-chunk-283-1.png" width="400px" height="100px" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="next-steps-2" class="section level2 hasAnchor" number="11.7">
<h2><span class="header-section-number">11.7</span> Next steps<a href="graphics-base.html#next-steps-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Complete alternative systems for generating graphics in R have been implemented as packages, specifically <code>lattice</code> and <code>ggplot2</code>. As these systems were designed more coherently, and built using more modern plotting infrastructure (the <code>grid</code>-package), they are more consistent in appearance than base graphics, and allow specification of complex high-level plots. We will have a close look at the <code>ggplot2</code>-package in Chapter <a href="graphics-ggplot2.html#graphics-ggplot2">12</a>.</p>
<p>In Section <a href="dynamic-documents.html#dynamic-documents">14</a>, we will have a short look at how to control the appearance of plots in compiled script and dynamic documents, building on the graphical device concept we have seen above.</p>
<p>As mentioned initially, there are many, many packages available that implement useful graphical functionality in base R. For example:</p>
<ul>
<li><code>forplo</code> implements a nice interface to specify forest plots.</li>
<li><code>hnp</code> offers sophisticated normal quantile plots for data and model residuals.</li>
<li><code>showtext</code> allows easier use of various fonts and fot types in R graphics<a href="#fn71" class="footnote-ref" id="fnref71"><sup>71</sup></a>.</li>
<li><code>khroma</code> adds a number of new palette functions for scientific visualization<a href="#fn72" class="footnote-ref" id="fnref72"><sup>72</sup></a>.</li>
<li>For the more theoretically inclined, the package <code>latex2exp</code> allows the use of expressions in R plots.</li>
</ul>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="59">
<li id="fn59"><p>See <a href="http://www.statsci.org/data/general/harvest.html" class="uri">http://www.statsci.org/data/general/harvest.html</a> for details and a link to the full data.<a href="graphics-base.html#fnref59" class="footnote-back">↩︎</a></p></li>
<li id="fn60"><p>See <code>example(pairs)</code> and <code>example(coplot)</code> to demonstrate both aspects.<a href="graphics-base.html#fnref60" class="footnote-back">↩︎</a></p></li>
<li id="fn61"><p>Technically, the function <code>ifelse</code> has three arguments: the first one is a logical vector, in our example generated via the logical expression <code>Harvest$Sex == "M"</code>, the second and third are vectors that specify which value is returned for <code>TRUE</code> and <code>FALSE</code>, respectively. Here, the alternatives are just the 1-element vectors <code>"blue"</code> and <code>"red"</code>, but as these are automatically extended to the length of the first argument, this works as intended (see also comments on the <code>round</code>-example in Section <a href="data-types-struct.html#vector-calculations">5.3.1</a>).<a href="graphics-base.html#fnref61" class="footnote-back">↩︎</a></p></li>
<li id="fn62"><p>There are some cases where interacting with plotting windows directly can be useful: e.g. the RStudio Plots-tab is not the most stable and may crash, so that it can be useful to close it with <code>dev.off()</code> and re-start it with a new plot, or explicitly with <code>dev.new()</code>. If the Plots-tab is already active, then each extra call of <code>dev.new()</code> will generate a new external plotting window, which can be helpful for large and/or complex plots, or for comparing two plots side-by-side.</p>
<p>Let’s look at a hypothetical example (replicate at the command line in a newly started RStudio session to see how it works interactively):</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Make sure we have an active Plots-tab...</span></span>
<span id="cb255-2"><a href="#cb255-2" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>))</span>
<span id="cb255-3"><a href="#cb255-3" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Start a new device outside of RStudio</span></span>
<span id="cb255-4"><a href="#cb255-4" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">dev.new</span>()</span>
<span id="cb255-5"><a href="#cb255-5" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb255-6"><a href="#cb255-6" tabindex="-1"></a><span class="sc">&gt;</span> <span class="do">### Close the device: kill window or...</span></span>
<span id="cb255-7"><a href="#cb255-7" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">dev.off</span>()</span>
<span id="cb255-8"><a href="#cb255-8" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Once more will close RStudio device</span></span>
<span id="cb255-9"><a href="#cb255-9" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">dev.off</span>()</span>
<span id="cb255-10"><a href="#cb255-10" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># New plot opens new device</span></span>
<span id="cb255-11"><a href="#cb255-11" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p>If you find this kind of thing useful, you will probably also want to look at the functions <code>dev.list</code>, <code>dev.cur</code> and <code>dev.set</code>.<a href="graphics-base.html#fnref62" class="footnote-back">↩︎</a></p></li>
<li id="fn63"><p>Note however that the device will generally only be a valid image file as described <em>after</em> you close the device - as long as the device is open, R still allows you to add more graphical elements, so the file is not complete yet; only by closing the device, you indicate that you are done with plotting, and the final version of the plot will be written out completely to hard disk.<a href="graphics-base.html#fnref63" class="footnote-back">↩︎</a></p></li>
<li id="fn64"><p>See <a href="https://en.wikipedia.org/wiki/Raster_graphics" class="uri">https://en.wikipedia.org/wiki/Raster_graphics</a> and <a href="https://en.wikipedia.org/wiki/Vector_graphics" class="uri">https://en.wikipedia.org/wiki/Vector_graphics</a> for details if you are unsure.<a href="graphics-base.html#fnref64" class="footnote-back">↩︎</a></p></li>
<li id="fn65"><p>Though it’s important to note that the different plotting functions may interpret these defaults differently, e.g. parameter <code>par(col="blue")</code> will have different effects for <code>hist(Harvest$BMI)</code>, <code>boxplot(Harvest$BMI)</code> and <code>plot(Harvest$BMI)</code>. As mentioned above, base graphics are not always strong on consistency.<a href="graphics-base.html#fnref65" class="footnote-back">↩︎</a></p></li>
<li id="fn66"><p>You may notice that the graphical parameter can be specified as either a character or an integer code - we have used characters in our examples so far, as they are simple and intuitive, but you can achieve some pleasing effects by using integer codes 1-25 instead: see <code>?points</code> for a handy reference.<a href="graphics-base.html#fnref66" class="footnote-back">↩︎</a></p></li>
<li id="fn68"><p><a href="https://en.wikipedia.org/wiki/RGB_color_model" class="uri">https://en.wikipedia.org/wiki/RGB_color_model</a><a href="graphics-base.html#fnref68" class="footnote-back">↩︎</a></p></li>
<li id="fn69"><p>Note that this is just the common true color standard used in most web design <a href="https://en.wikipedia.org/wiki/24-bit_color#True_color_(24-bit)" class="uri">https://en.wikipedia.org/wiki/24-bit_color#True_color_(24-bit)</a><a href="graphics-base.html#fnref69" class="footnote-back">↩︎</a></p></li>
<li id="fn70"><p>Named not after a brewery, but after Cynthia Brewer, a geographer who designed the palettes for use in maps, see <a href="https://en.wikipedia.org/wiki/Cynthia_Brewer#Brewer_palettes" class="uri">https://en.wikipedia.org/wiki/Cynthia_Brewer#Brewer_palettes</a><a href="graphics-base.html#fnref70" class="footnote-back">↩︎</a></p></li>
<li id="fn71"><p>Note that fonts and font installation will depend on your operating system setup, so results may vary.<a href="graphics-base.html#fnref71" class="footnote-back">↩︎</a></p></li>
<li id="fn72"><p>Actually, a utility for generating your own palette function, based on pre-defined color schemes for sequential, qualitative and divergent representation.<a href="graphics-base.html#fnref72" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression-other.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphics-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/graphics_base.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["introductio-to-r.pdf", "introductio-to-r.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
